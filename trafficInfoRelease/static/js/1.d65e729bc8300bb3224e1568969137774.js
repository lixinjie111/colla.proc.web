webpackJsonp([1],{"6CnR":function(t,e){},AOsJ:function(t,e,a){a("H3hg"),t.exports=a("Rv9F").Object.keys},H3hg:function(t,e,a){var i=a("Myb3"),s=a("E5yg");a("tTxE")("keys",function(){return function(t){return s(i(t))}})},Z4V1:function(t,e){},ZLEe:function(t,e,a){t.exports={default:a("AOsJ"),__esModule:!0}},hx1w:function(t,e){},jh8w:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("ZLEe"),s=a.n(i),n=a("2D3L"),o={name:"vehicleInfoTag",props:{title:String,infoTagData:Array},data:function(){return{}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-wrapper-20 c-detail-box"},[t.title?a("p",{staticClass:"c-title",class:t.infoTagData.length?"":"c-border-bottom"},[t._v(t._s(t.title))]):t._e(),t._v(" "),t.infoTagData.length?a("ul",{staticClass:"c-detail-table-vertical clearfix"},t._l(t.infoTagData,function(e,i){return a("li",{key:i,staticClass:"list",style:{"margin-top":e.title?"0":"-1px"}},[e.title?a("p",{staticClass:"title"},[t._v(t._s(e.title))]):t._e(),t._v(" "),t._l(e.list,function(e,i){return a("div",{key:i,staticClass:"inner-list"},[a("span",{staticClass:"sub-title"},[t._v(t._s(e.name))]),t._v(" "),a("em",{staticClass:"desc",attrs:{title:e.value||"--"}},[t._v(t._s(e.value||"--"))])])})],2)}),0):a("div",{staticClass:"c-empty-box"},[t._v("暂无数据")])])},staticRenderFns:[]};var r=a("C7Lr")(o,l,!1,function(t){a("Z4V1")},"data-v-2557cdee",null).exports,c={props:{visiblePlay:Boolean,vcrData:Object},data:function(){return{playerOptions:{playbackRates:[.7,1,1.5,2],overNative:!0,controls:!0,autoplay:!1,muted:!0,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{type:"video/mp4",src:this.vcrData.url}],poster:"",notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!1,durationDisplay:!1,currentTimeDisplay:!1,fullscreenToggle:!0,remainingTimeDisplay:!1,captionsButton:!1,chaptersButton:!1,subtitlesButton:!1,liveDisplay:!1,playbackRateMenuButton:!1}}}},methods:{cancleFunc:function(){this.$emit("cancleFunc")}},computed:{player:function(){return this.$refs.videoPlayer.player}},beforeDestroy:function(){var t=this;this.player.pause(),setTimeout(function(){t.player.dispose()},0)}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-video-player"},[a("el-dialog",{attrs:{title:"序列号： "+t.vcrData.serialNum,visible:t.visiblePlay,"before-close":t.cancleFunc,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(e){t.visiblePlay=e}}},[a("video-player",{ref:"videoPlayer",staticClass:"vjs-custom-skin",attrs:{options:t.playerOptions,playsinline:!0}})],1)],1)},staticRenderFns:[]};var d={components:{VideoPlayer:a("C7Lr")(c,u,!1,function(t){a("zBZH")},null,null).exports},props:{videoData:Array},data:function(){return{visiblePlay:!1,vcrData:null}},mounted:function(){},methods:{playVideo:function(t){this.visiblePlay=!0},cancleFunc:function(){this.visiblePlay=!1}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"c-video-list-wrapper c-detail-box c-padding-10 clearfix"},[t.videoData.length?t._l(t.videoData,function(e,i){return a("li",{key:i,staticClass:"c-video-list"},[a("div",{staticClass:"c-video-16-9"},[a("div",{staticClass:"c-video"},[a("div",{staticClass:"c-video-title"},[a("span",[t._v(t._s("序列号： "+e.serialNum))])]),t._v(" "),a("div",{staticClass:"c-video-mask"},[a("i",{staticClass:"el-icon-video-play",on:{click:t.playVideo}})])]),t._v(" "),t.visiblePlay?a("video-player",{attrs:{visiblePlay:t.visiblePlay,vcrData:e},on:{cancleFunc:t.cancleFunc}}):t._e()],1)])}):a("li",{staticClass:"c-video-list"},[t._m(0)])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"c-video-16-9"},[e("div",{staticClass:"c-video"},[e("div",{staticClass:"c-video-mask"},[e("div",{staticClass:"c-empty-box"},[this._v("暂无视频")])])])])}]};var v=a("C7Lr")(d,p,!1,function(t){a("6CnR")},null,null).exports,h={props:{detailData:Array,infoData:String,taskCode:String},components:{VehicleInfoTag:r,HistoryVideo:v},data:function(){return{isScaleMap:!1,isShowVideo:!1,videoData:[]}},mounted:function(){this.getHistoryDetail()},watch:{taskCode:function(t,e){t!==e&&this.getHistoryDetail()}},methods:{getHistoryDetail:function(){var t=this,e={taskCode:this.taskCode};this.$api.post("event/task/getEventDetail",e,function(e){200===e.data.status?(t.videoData=e.data.data.videoList,t.isShowVideo=!0):(e.data.message&&t.$message({type:"error",duration:"1500",message:e.data.message,showClose:!0}),t.isShowVideo=!0)})},backClick:function(){this.$emit("infoHistoryBack")}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-view-dialog"},[a("div",{staticClass:"c-scroll-wrap"},[a("div",{staticClass:"c-scroll-inner"},[a("div",{staticClass:"c-title-fixed"},[a("h3",{staticClass:"c-title"},[t._v("\n          信息历史\n          "),a("i",{staticClass:"el-icon-arrow-right"}),t._v("详情\n          "),a("el-page-header",{staticClass:"c-return-btn",on:{back:t.backClick}})],1)]),t._v(" "),a("vehicle-info-tag",{attrs:{title:"基本信息",infoTagData:t.detailData}}),t._v(" "),a("div",{staticClass:"c-wrapper-20 c-detail-box m-desc c-flex"},[a("span",{staticClass:"title"},[t._v("内容详情")]),t._v(" "),a("span",{staticClass:"desc",attrs:{title:t.infoData||"--"}},[t._v(t._s(t.infoData||"--"))])]),t._v(" "),a("div",{staticClass:"c-wrapper-20 c-detail-box"},[a("p",{staticClass:"c-title c-border-bottom"},[t._v("历史视频")]),t._v(" "),a("history-video",{directives:[{name:"show",rawName:"v-show",value:t.isShowVideo,expression:"isShowVideo"}],attrs:{videoData:t.videoData}})],1)],1)])])},staticRenderFns:[]};var f={components:{InfoHistoryDetail:a("C7Lr")(h,m,!1,function(t){a("hx1w")},"data-v-2e02993c",null).exports},data:function(){return{dataList:[],TDate:n.a,search:{eventType:"",status:"",publishTime:"",startTime:"",endTime:"",datasource:""},paging:{index:0,size:10,total:0},statusList:[{id:1,name:"有效",key:1},{id:2,name:"失效",key:2},{id:3,name:"完成",key:3}],datasourceList:[],oldTime:null,timeInterval:400,isLoading:!1,detailData:[],isShow:!1,infoData:"",taskCode:""}},created:function(){this.initDatasourceList(),this.init()},mounted:function(){},methods:{handleScroll:function(t){console.log(t)},init:function(){this.initSearch(),this.initPaging(),this.initData()},initPaging:function(){this.paging.index=0,this.paging.total=0,this.paging.size=10},initSearch:function(){this.search={eventType:"",status:"",publishTime:"",startTime:"",endTime:"",datasource:""}},initData:function(t){var e=this;this.isLoading=!0;var a={eventType:this.search.eventType,status:this.search.status,beginTime:this.search.startTime,endTime:this.search.endTime,datasource:this.search.datasource,page:{pageIndex:this.paging.index,pageSize:this.paging.size}};this.$api.post("event/task/queryPage",a,function(t){t.status>=200&&t.status<300?(e.dataList=t.data.list,e.$refs.table.bodyWrapper.scrollTop=0,e.paging.total=t.data.totalCount):e.$message({type:"error",duration:"1500",message:"获取设备列表失败  ！",showClose:!0}),e.isLoading=!1})},initDatasourceList:function(){var t=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments[1];this.$api.post("common/queryDictionary",{parentCode:"trafficSource"},function(e){e.status>=200&&e.status<300?t.datasourceList=e.data?e.data:[]:t.$message({type:"error",duration:"1500",message:"获取单位失败 ！",showClose:!0})})},handleSearch:function(){if(Array.isArray(this.search.publishTime)){var t=this.search.publishTime[0],e=this.search.publishTime[1];this.search.startTime=n.a.dateToMs(t),this.search.endTime=n.a.dateToMs(e)}this.initData()},handleFlush:function(){this.initSearch(),this.initData()},pagingChange:function(t){this.paging.index=t-1,this.initData()},saveWater:function(){var t=(new Date).getTime();this.oldTime||(this.oldTime=t),this.newTime-this.oldTime>this.timeInterval&&(this.oldTime=t,this.initData())},saveWater2:function(){},checkDetail:function(t){t.beginTime=n.a.formatTime(t.beginTime),t.createTime=n.a.formatTime(t.createTime),t.endTime=n.a.formatTime(t.endTime),t.expirationTime=n.a.formatTime(t.expirationTime);var e,a=t;e=[a].map(function(t){return parseFloat(t.longitude).toFixed(8)+","+parseFloat(t.latitude).toFixed(8)}),this.isShow=!0;var i=[];this.infoData=a.content,s()(a).forEach(function(t){i.push({name:"taskCode"===t?"信息编号":"eventName"===t?"信息类型":"eventCode"===t?"事件编号":"beginTime"===t?"事件发生时间":"endTime"===t?"事件结束时间":"longitude"===t?"事件发生位置":"createTime"===t?"发布开始时间":"expirationTime"===t?"发布结束时间":"sendNumber"===t?"累计发送次数":void 0,value:"longitude"===t?a[t]=e[0]:a[t]})}),i=i.filter(function(t){return void 0!==t.name}),this.splitArr(i),this.taskCode=t.taskCode},splitArr:function(t){var e=0;this.detailData=[];for(var a=0;a<t.length;a++)a%3==0&&0!==a&&(this.detailData.push({title:"",list:t.slice(e,a)}),e=a),a+1===t.length&&this.detailData.push({title:"",list:t.slice(e,a+1)});return this.detailData},infoHistoryBack:function(){this.isShow=!1}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-wrapper-20"},[a("el-form",{attrs:{inline:!0,size:"mini"}},[a("el-form-item",{attrs:{label:"信息类型："}},[a("el-input",{model:{value:t.search.eventType,callback:function(e){t.$set(t.search,"eventType","string"==typeof e?e.trim():e)},expression:"search.eventType"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"信息状态："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.search.status,callback:function(e){t.$set(t.search,"status",e)},expression:"search.status"}},t._l(t.statusList,function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.key}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"发布时间："}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:t.search.publishTime,callback:function(e){t.$set(t.search,"publishTime",e)},expression:"search.publishTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"信息来源："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.search.datasource,callback:function(e){t.$set(t.search,"datasource",e)},expression:"search.datasource"}},t._l(t.datasourceList,function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.key}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"warning"},on:{click:t.handleSearch}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"warning",plain:""},on:{click:t.handleFlush}},[t._v("刷新")])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"table",staticClass:"c-mb-70",attrs:{"max-height":"724",data:t.dataList,border:"",stripe:"","header-cell-style":{background:"#E6E6E6",color:"#606266",border:"0px"}}},[a("el-table-column",{attrs:{label:"序号",type:"index"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.$index+t.paging.index*t.paging.size+1))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"taskCode",label:"信息编号","min-width":"13%"}}),t._v(" "),a("el-table-column",{attrs:{prop:"eventName",label:"信息类型","min-width":"6%"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"信息状态","min-width":"6%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:1==e.row.status,expression:"scope.row.status == 1"}]},[t._v("有效")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:2==e.row.status,expression:"scope.row.status == 2"}]},[t._v("失效")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:3==e.row.status,expression:"scope.row.status == 3"}]},[t._v("完成")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"longitude,latitude ",label:"中心位置","min-width":"15%"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(parseFloat(e.row.longitude).toFixed(8))+" , "+t._s(parseFloat(e.row.latitude).toFixed(8)))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"发布开始时间","min-width":"12%"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.TDate.formatTime(e.row.beginTime)))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"发布结束时间","min-width":"12%"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(0==e.row.expirationTime?"--":t.TDate.formatTime(e.row.expirationTime)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"content",label:"信息内容","min-width":"15%"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sendNumber",label:"下发次数","min-width":"6%"}}),t._v(" "),a("el-table-column",{attrs:{prop:"datasource",label:"信息来源","min-width":"8%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(1===e.row.datasource?"平台运营人员":"融合计算"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"5%",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",icon:"el-icon-view",circle:"",type:"warning",plain:""},nativeOn:{click:function(a){return t.checkDetail(e.row)}}})]}}])})],1),t._v(" "),a("el-row",{staticClass:"c-page"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":this.paging.size,total:this.paging.total},on:{"current-change":t.pagingChange}})],1),t._v(" "),t.isShow?a("info-history-detail",{attrs:{taskCode:t.taskCode,detailData:t.detailData,infoData:t.infoData},on:{infoHistoryBack:t.infoHistoryBack}}):t._e()],1)},staticRenderFns:[]},b=a("C7Lr")(f,g,!1,null,null,null);e.default=b.exports},tTxE:function(t,e,a){var i=a("8leu"),s=a("Rv9F"),n=a("9tun");t.exports=function(t,e){var a=(s.Object||{})[t]||Object[t],o={};o[t]=e(a),i(i.S+i.F*n(function(){a(1)}),"Object",o)}},zBZH:function(t,e){}});
//# sourceMappingURL=1.d65e729bc8300bb3224e1568969137774.js.map